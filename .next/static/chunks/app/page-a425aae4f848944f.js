(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9319:function(e,r,o){Promise.resolve().then(o.bind(o,6025)),Promise.resolve().then(o.bind(o,1985))},6025:function(e,r,o){"use strict";o.d(r,{default:function(){return b}});var t=o(7437),a=o(2265),n=o(1326),i=o(5965),s=o(511),l=o(8700),d=o(998),c=o(7818),u=o(6463),x=o(8904);let h=(0,c.default)(()=>o.e(823).then(o.bind(o,823)),{loadableGenerated:{webpack:()=>[823]},ssr:!1});function b(){let{data:e,status:r}=(0,d.useSession)(),o=(0,u.useRouter)(),[c,b]=(0,a.useState)([]),[p,f]=(0,a.useState)(""),[g,m]=(0,a.useState)(!1),[k,w]=(0,a.useState)({}),v=(0,a.useRef)(null),[y,C]=(0,a.useState)(0),[j,S]=(0,a.useState)("");if((0,a.useEffect)(()=>{"unauthenticated"===r?o.push("/login"):"authenticated"===r&&b([{role:"assistant",content:"Welcome back, ".concat(e.user.name,"! I'm your guide to Africana Diaspora Religions. How can I assist you today?")}])},[r,o,e]),(0,a.useEffect)(()=>{var e;null===(e=v.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[c]),"loading"===r)return(0,t.jsx)("div",{children:"Loading..."});if(!e)return null;let R=async()=>{if(!p.trim())return;m(!0);let r={role:"user",content:p};b(e=>[...e,r]),f("");try{var o;let r=await fetch("/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:p,history:c.slice(1),userEmail:(null==e?void 0:null===(o=e.user)||void 0===o?void 0:o.email)||null})});if(!r.ok)throw Error("HTTP error! status: ".concat(r.status));let t=await r.json();b(e=>[...e,{role:"assistant",content:t.message}])}catch(e){console.error("Error sending message:",e),b(e=>[...e,{role:"assistant",content:"Sorry, there was an error processing your request."}])}finally{m(!1)}},Z=async()=>{try{let e=await fetch("/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({rating:y,feedbackText:j})});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));C(0),S(""),alert("Thank you for your feedback!")}catch(e){console.error("Error submitting feedback:",e),alert("There was an error submitting your feedback. Please try again.")}};return(0,t.jsxs)(n.Z,{width:"100vw",height:"100vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",sx:{background:"linear-gradient(135deg, #E75A7C 0%, #2C363F 100%)",fontFamily:"'Roboto', sans-serif"},children:[(0,t.jsx)(i.Z,{variant:"contained",onClick:()=>(0,d.signOut)(),sx:{position:"absolute",top:16,right:16,backgroundColor:"#4285F4","&:hover":{backgroundColor:"#357ae8"}},children:"Sign out"}),(0,t.jsx)(s.Z,{variant:"h3",sx:{color:"#0F1020",marginBottom:4,fontWeight:"bold",textShadow:"2px 2px 4px rgba(0,0,0,0.5)",fontFamily:"'Times New Roman', serif"},children:"AfriReligions AI"}),(0,t.jsxs)(l.Z,{direction:"column",width:"600px",height:"700px",sx:{background:"rgba(242, 245, 234, 0.8)",borderRadius:"20px",boxShadow:"0 8px 32px 0 rgba(44, 54, 63, 0.37)",backdropFilter:"blur(8px)",border:"1px solid rgba(187, 199, 164, 0.18)"},p:3,spacing:3,children:[(0,t.jsxs)(l.Z,{direction:"column",spacing:2,flexGrow:1,overflow:"auto",maxHeight:"100%",position:"relative",sx:{"&::-webkit-scrollbar":{width:"8px"},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-thumb":{background:"rgba(0,0,0,0.2)",borderRadius:"4px"}},children:[c.map((e,r)=>(0,t.jsx)(n.Z,{display:"flex",flexDirection:"column",alignItems:"assistant"===e.role?"flex-start":"flex-end",children:(0,t.jsx)(n.Z,{sx:{bgcolor:"assistant"===e.role?"#6B8E23":"#8B4513",color:"white",borderRadius:"assistant"===e.role?"20px 20px 20px 5px":"20px 20px 5px 20px",p:2,maxWidth:"80%",boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)",fontWeight:300,wordBreak:"break-word",whiteSpace:"pre-wrap",overflowWrap:"break-word","& ul, & ol":{paddingLeft:"1.5em",marginLeft:"0.5em"}},children:(0,t.jsx)(x.U,{children:e.content})})},r)),(0,t.jsx)("div",{ref:v})]}),(0,t.jsxs)(l.Z,{direction:"row",spacing:2,children:[(0,t.jsx)(h,{label:"Message",fullWidth:!0,value:p,onChange:e=>f(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),R())},multiline:!0,maxRows:4,disabled:g,sx:{"& .MuiOutlinedInput-root":{borderRadius:"15px",backgroundColor:"rgba(255, 255, 255, 0.9)"}}}),(0,t.jsx)(i.Z,{variant:"contained",onClick:R,disabled:g||!p.trim(),sx:{borderRadius:"15px",backgroundColor:"#4caf50","&:hover":{backgroundColor:"rgba(255, 255, 255, 0.9)"}},children:"Send"})]})]}),(0,t.jsxs)(n.Z,{position:"fixed",bottom:8,right:8,display:"flex",flexDirection:"column",alignItems:"center",zIndex:1e3,sx:{backgroundColor:"rgba(214, 219, 210, 0.9)",padding:"16px",borderRadius:"20px",boxShadow:"0 2px 4px rgba(44, 54, 63, 0.1)",width:"300px"},children:[(0,t.jsx)(s.Z,{variant:"body2",sx:{mb:1,color:"#2C363F"},children:"Rate this conversation"}),(0,t.jsx)(n.Z,{display:"flex",flexDirection:"row",mb:2,children:[1,2,3,4,5].map(e=>(0,t.jsx)(i.Z,{onClick:()=>C(e),sx:{minWidth:"auto",p:1,color:y>=e?"#FFD700":"#C0C0C0","&:hover":{backgroundColor:"transparent"}},children:"â˜…"},e))}),(0,t.jsx)(h,{multiline:!0,rows:3,variant:"outlined",placeholder:"Your feedback (optional)",value:j,onChange:e=>S(e.target.value),fullWidth:!0,sx:{mb:2}}),(0,t.jsx)(i.Z,{variant:"contained",onClick:Z,disabled:!y,fullWidth:!0,sx:{backgroundColor:"#4caf50","&:hover":{backgroundColor:"#45a049"}},children:"Submit Feedback"})]})]})}},1985:function(e,r,o){"use strict";o.d(r,{Providers:function(){return n}});var t=o(7437),a=o(998);function n(e){let{children:r}=e;return(0,t.jsx)(a.SessionProvider,{children:r})}}},function(e){e.O(0,[842,838,971,23,744],function(){return e(e.s=9319)}),_N_E=e.O()}]);